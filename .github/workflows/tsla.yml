name: TSLA Market Maker Auto Monitor

on:
  # æ¯6å°æ™‚è‡ªå‹•åŸ·è¡Œ
  schedule:
    - cron: '0 */6 * * *'  # æ¯å¤© 00:00, 06:00, 12:00, 18:00 UTC
  
  # æ‰‹å‹•è§¸ç™¼
  workflow_dispatch:
  
  # Push æ™‚ä¹Ÿè§¸ç™¼ï¼ˆç”¨æ–¼æ¸¬è©¦ï¼‰
  push:
    branches: [ main ]

jobs:
  tsla-analysis:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout repository
      uses: actions/checkout@v4
    
    - name: ğŸ Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
    
    - name: ğŸ“¦ Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install requests python-dateutil
    
    - name: ğŸš€ Run TSLA Market Maker Analysis
      env:
        TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
        TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        NOTION_TOKEN: ${{ secrets.NOTION_TOKEN }}
        NOTION_DATABASE_ID: ${{ secrets.NOTION_DATABASE_ID }}
      run: |
        echo "ğŸ¯ é–‹å§‹ TSLA Market Maker åˆ†æ..."
        echo "â° åŸ·è¡Œæ™‚é–“: $(date)"
        echo "ğŸŒ æ™‚å€: UTC"
        python tsla_mm_analyzer.py
    
    - name: ğŸ“Š Log execution results
      run: |
        echo "âœ… TSLA åˆ†æåŸ·è¡Œå®Œæˆ"
        echo "ğŸ“… å®Œæˆæ™‚é–“: $(date)"
        echo "ğŸ”„ ä¸‹æ¬¡åŸ·è¡Œ: 6å°æ™‚å¾Œ"
    
    - name: ğŸ‰ Success notification
      if: success()
      run: |
        echo "ğŸ¯ TSLA Market Maker ç›£æ§ç³»çµ±é‹è¡ŒæˆåŠŸï¼"
        echo "ğŸ“± å ±å‘Šå·²ç™¼é€åˆ° Telegram"
        echo "ğŸ“ è³‡æ–™å·²æ›´æ–°åˆ° Notionï¼ˆå¦‚å·²é…ç½®ï¼‰"
    
    - name: âŒ Failure notification
      if: failure()
      run: |
        echo "âš ï¸ TSLA ç›£æ§ç³»çµ±åŸ·è¡Œå¤±æ•—"
        echo "è«‹æª¢æŸ¥ GitHub Actions æ—¥èªŒ"
